"use strict";System.register(["jsx!pages/page","requests/request","model/user"],function(t,e){function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var r,c,o,s,p,l,u;return{setters:[function(t){r=t["default"]},function(t){c=t["default"]},function(t){o=t["default"]}],execute:function(){s=function(){function t(t,e){var i=[],n=!0,a=!1,r=void 0;try{for(var c,o=t[Symbol.iterator]();!(n=(c=o.next()).done)&&(i.push(c.value),!e||i.length!==e);n=!0);}catch(s){a=!0,r=s}finally{try{!n&&o["return"]&&o["return"]()}finally{if(a)throw r}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),p=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=function e(t,i,n){null===t&&(t=Function.prototype);var a=Object.getOwnPropertyDescriptor(t,i);if(void 0===a){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,i,n)}if("value"in a)return a.value;var c=a.get;if(void 0!==c)return c.call(n)},u=function(t){function e(){i(this,e);var t=n(this,Object.getPrototypeOf(e).call(this,"final"));return t.timeout=2e4,t.title="",t.description="",t.receipt="",t.canEditIdentification=!1,t.showReceipt=!1,t._confirmExit=!1,t}return a(e,t),p(e,[{key:"onShow",value:function(){var t=this;l(Object.getPrototypeOf(e.prototype),"onShow",this).call(this);var i=this.session.get("receipt");this.title=i.title,this.description=i.description,this.checkPaymentStatus=i.checkPaymentStatus,this.receipt=i.receipt,this.showReceipt=i.hasReceipt,this.canEditIdentification="simple"===i.identificationStatus,this.receiptPrinted=i.receiptPrinted,this.account=i.account,this.phone=i.phone,this.transactionCode=i.transactionCode,this.isSmsNotificationEnabled=i.isSmsNotificationEnabled,this.update(),this.updateNavigation({nextButton:{visible:!1},prevButton:{visible:!1}}),(new c).send("network.p3",{app_key:"fnhhmebhedcccmdoheldmjlhcckmgcoh",params:{account:this.account?this.account:this.phone},id:1,method:"action",timeout:10}).then(function(e){var i=JSON.parse(e.response.body);if(i.response){var n=i.response.response.result;n&&t.session.set("previousEmail",JSON.parse(n[n.length-1]).ate_email)}},function(t){})["catch"](function(t){}).done()}},{key:"editIdentification",value:function(){this.jump("ident")}},{key:"sendMail",value:function(){this.jump("email")}},{key:"createClass",value:function(){var t=this;return this.loadElements(["textimage","button","advert"]).then(function(i){var n=s(i,3),a=n[0],r=n[1],c=n[2];return l(Object.getPrototypeOf(e.prototype),"createClass",t).call(t,{componentDidMount:function(){"receipt"===React.findDOMNode(this).lastChild.className&&this.setState({receiptWarning:React.findDOMNode(this).lastChild.children[1].firstChild.scrollHeight>500})},getInitialState:function(){return{receiptWarning:!1}},render:function(){var t=this,e=this.props.context,i=this.props.receipt?React.createElement("div",{className:"receipt"},React.createElement("div",{className:"title"},"Электронная квитанция"),React.createElement("div",{className:"text"},React.createElement("div",null,this.props.receipt.replace(/<br\/?>/g,"\n")),this.state.receiptWarning?React.createElement("div",{className:"blur"}):null),this.state.receiptWarning?React.createElement("div",{className:"full-receipt"},"Это фрагмент квитанции. Получите ее целиком на ваш e-mail"):null,React.createElement(r,{className:"option-button",text:"Выслать на электронную почту",onClick:function(){return e.sendMail()}})):null;return React.createElement("div",{id:"final-page"},React.createElement("div",{className:"main"+(this.props.receipt?"":" noreceipt")},React.createElement("div",{className:"qiwi"+(this.props.receipt?"":" noreceipt")},React.createElement("img",{src:"img/qiwi_big.png"})),React.createElement("div",{className:"info"+(this.props.receipt?"":" noreceipt")},React.createElement(a,{className:"title"+(this.props.receipt?" hasreceipt":" noreceipt"),img:"img/icons/ok.png",text:this.props.page.title,margin:"20",style:{text:{width:"400px"}}}),React.createElement("div",{className:"description"+(this.props.receipt?" hasreceipt":" noreceipt")},this.props.page.description),this.props.checkPaymentStatus?React.createElement("div",{className:"checkStatusButton"+(this.props.receipt?"":" noreceipt")},React.createElement(r,{className:"option-button",text:"Проверить статус платежа",onClick:function(){return t.props.checkStatus()}})):null),this.props.canEditIdentification?React.createElement("div",{className:"editButton"+(this.props.receipt?"":" noreceipt")},React.createElement(r,{className:"option-button",text:"Изменить личные данные",onClick:function(){return e.editIdentification()}})):null),React.createElement(c,{adv_width:"1280",adv_height:"170",y_pos:"694",params:this.props.data,x_pos:"0",place:"w_ereceipt",onExit:function(t){return e.exit(t)},onStopTimer:function(){return e.onHide()}}),i)}})})}},{key:"state",get:function(){var t=this;return{canEditIdentification:this.canEditIdentification,receipt:this.showReceipt?this.receipt:null,receiptPrinted:this.receiptPrinted,page:{description:this.description,title:this.title},data:{account:this.account,phone:this.phone,transactionCode:this.transactionCode,walletSubscriptionFee:this.isSmsNotificationEnabled},checkPaymentStatus:this.checkPaymentStatus,checkStatus:function(){t.openInterfacePage({page:"fake_status",data:{payInfo:{config:{name:t.checkPaymentStatus.providerName},faccount:t.checkPaymentStatus.account,sum:{enrolled:t.checkPaymentStatus.paySumm}}}})}}}}]),e}(r),t("default",u)}}});