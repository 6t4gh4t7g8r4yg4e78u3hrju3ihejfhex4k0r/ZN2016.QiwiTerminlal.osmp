"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _slicedToArray=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(u){i=!0,o=u}finally{try{!r&&a["return"]&&a["return"]()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_get=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var s=i.get;if(void 0!==s)return s.call(r)};define(["jsx!pages/page","../model/gibddDuty","payment","depot"],function(e,t,n,r){var i=function(e){function i(e){return _classCallCheck(this,i),_possibleConstructorReturn(this,Object.getPrototypeOf(i).call(this,e||"selectDivision"))}return _inherits(i,e),_createClass(i,[{key:"onShow",value:function(){var e=this;_get(Object.getPrototypeOf(i.prototype),"onShow",this).call(this),this.setLogo(n.state.logo),this.showPreloader(),r.get("gibdd_divisions_"+t.type).then(function(e){return e||Promise.reject()}).then(function(e){var n=e.region,r=e.code;return t.division={code:r,region:n},qiwi.utils.require("text!../../json/flash_gibdd_duties_divisions.json")}).then(function(e){var n=_slicedToArray(e,1),r=n[0],i=JSON.parse(r).filter(function(e){return e.id===t.division.region})[0].subdivisions.filter(function(e){return e.subdivision_code===t.division.code})[0],o=i.address,s=i.name;try{t.division={address:o,name:s}}catch(a){return Promise.reject(a)}})["catch"](function(t){return e.jump("another")}).then(function(){return e.request("wallet.get-duties-requisities",{version:qiwi.application.toString(),region:t.division.region,type:t.type,div:t.division.code})}).then(function(n){var r=n.response.data.info,i=(r.subdivision,r.to_name_f),o=r.to_bank,s=r.inn,a=r.kpp,u=r.okato,c=r.cre,l=r.rec_bik,d=r.kbk,f=r.online;e.hidePreloader(),t.division={recepient:i,bank:o,inn:s,kpp:a,okato:u,kbk:d,online:f,account:c,bik:l},e.buttons=[{text:t.division.name,onClick:function(){return e.performForward()},extra:t.divisionDescription},{text:qiwi.i18n("gibdd_duties.selectDivision.another_division"),onClick:function(){return e.jump("another")}}],e.update()},function(t){return e.showPopup({type:"error",message:t.message,okHandler:function(){return e.performBackward()}})}).done()}},{key:"createClass",value:function(){var e=this;return this.loadElements(["buttons","pageHeader"]).then(function(t){var n=_slicedToArray(t,2),r=n[0],o=n[1];return _get(Object.getPrototypeOf(i.prototype),"createClass",e).call(e,{getDefaultProps:function(){return{buttons:[]}},render:function(){return React.createElement("div",{className:"select-division"},React.createElement(o,{provider:this.props.providerName,title:qiwi.i18n("gibdd_duties.selectDivision.header")}),React.createElement(r,{buttons:this.props.buttons.map(function(e){return qiwi.utils.extend(qiwi.utils.clone(e),e.extra?{extra:React.createElement("div",{className:"below"},React.createElement("div",null,e.extra))}:{},{className:e.text.length>=60?"small":e.text.length>=30?"medium":""})})}))}})})}},{key:"state",get:function(){return{buttons:this.buttons,providerName:n.state.provider.fullName}}}]),i}(e);return i});