"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _slicedToArray=function(){function e(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(c){i=!0,o=c}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_get=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)};define(["jsx!pages/page","payment","stores/regProvider","terminal","../model/gibddDuty","model/user","commissions","depot"],function(e,t,r,n,i,o,a,s){var c=function(e){function c(e){_classCallCheck(this,c);var u=_possibleConstructorReturn(this,Object.getPrototypeOf(c).call(this,e||"selectCategory"));return n.send("GetPrtStatus","true","PrtStatus").then(function(e){var t=e.PrtStatus;return"OK"===t?Promise.resolve():Promise.reject(qiwi.i18n("errors.printerError"))}).then(function(){return n.send("PrvId",t.state.provider.id,"PrvAllow|PrvDenied")}).then(function(e){var t=e.PrvAllow;return t?Promise.resolve():Promise.reject()}).then(function(){return r.getProvider(u.storage.get("provider"))}).then(function(e){t.state.logo="../img/ui_item/"+e.logo,t.state.minSum=e.minSum,t.state.maxSum=e.maxSum,t.state.provider.fullName=e.longName,t.state.paymentSchema=t.schemas.QW_OFFLINE,t.state.qwCommissions=new a(t.state.qwCommissionsSource,t.state.provider.id),o.currentCurrency=t.state.currency,n.send("GetMaxSummByPrv",t.state.provider.id,"GetMaxSummByPrv").then(function(e){return t.state.maxSum=e.GetMaxSummByPrv}),u.setLogo(t.state.logo),u.update()})["catch"](function(e){return u.showPopup({type:"error",title:qiwi.i18n("errors.default"),message:"string"==typeof e?e:qiwi.i18n("errors.providerDenied"),okHandler:function(){return u.exit()}})}).done(),s.init({style:"flash"}),u.buttons=[{text:qiwi.i18n("category.driver_license"),onClick:function(){i.type="exm",u.forward()},icon:"../projects/gibdd-duties/img/driver_license_icon.png",extra:"../projects/gibdd-duties/img/driver_license.png"},{text:qiwi.i18n("category.car_license"),onClick:function(){i.type="reg",u.forward()},icon:"../projects/gibdd-duties/img/car_license_icon.png",extra:"../projects/gibdd-duties/img/car_license.png"}],u}return _inherits(c,e),_createClass(c,[{key:"performBackward",value:function(){this.exit()}},{key:"onShow",value:function(){_get(Object.getPrototypeOf(c.prototype),"onShow",this).call(this),this.updateNavigation({nextButton:{visible:!1}}),t.state.logo&&this.setLogo(t.state.logo),this.update()}},{key:"createClass",value:function(){var e=this;return this.loadElements(["buttons","pageHeader"]).then(function(t){var r=_slicedToArray(t,2),n=r[0],i=r[1];return _get(Object.getPrototypeOf(c.prototype),"createClass",e).call(e,{render:function(){return React.createElement("div",{className:"select-category"},React.createElement(i,{provider:this.props.providerName,title:qiwi.i18n("gibdd_duties.selectCategory.header")}),React.createElement(n,{buttons:this.props.buttons.map(function(e){return qiwi.utils.extend(qiwi.utils.clone(e),e.extra?{extra:React.createElement("div",{className:"above"},React.createElement("div",null,React.createElement("img",{src:e.extra})))}:{})})}))}})})}},{key:"state",get:function(){return{providerName:t.state.provider.fullName,buttons:this.buttons}}}]),c}(e);return c});