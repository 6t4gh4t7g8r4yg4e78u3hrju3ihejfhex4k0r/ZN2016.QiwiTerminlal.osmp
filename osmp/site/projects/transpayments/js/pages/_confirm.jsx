"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_get=function(a,b,c){for(var d=!0;d;){var e=a,f=b,g=c;h=j=i=void 0,d=!1,null===e&&(e=Function.prototype);var h=Object.getOwnPropertyDescriptor(e,f);if(void 0!==h){if("value"in h)return h.value;var i=h.get;return void 0===i?void 0:i.call(g)}var j=Object.getPrototypeOf(e);if(null===j)return void 0;a=j,b=f,c=g,d=!0}};define("../../projects/transpayments/js/pages/_confirm",["jsx!pages/page","../utils/rate"],function(a,b){var c=function(a){function c(){_classCallCheck(this,c),_get(Object.getPrototypeOf(c.prototype),"constructor",this).call(this,"_confirm")}return _inherits(c,a),_createClass(c,[{key:"onShow",value:function(){var a=this;_get(Object.getPrototypeOf(c.prototype),"onShow",this).call(this),this.setHeader("","",this.session.get("regProvider").shortName),this.setLogo(this.session.get("regProvider").logo?"../img/ui_item/"+this.session.get("regProvider").logo:"../projects/transpayments/img/logo.png"),"0;0"==this.session.get("provider").rates||this.session.get("provider").rate?(this.session.get("provider").rate&&(this.rateInfo=this.session.get("provider").rate.formattedRate()),this.update()):this.request("wallet.get-cross-rates",{rates:this.getRates(),version:qiwi.application.toString()}).done(function(b){a.parseRate(b.response.bodyXml),a.update()},function(b){a.rateInfo=qiwi.i18n("all_pages.default_rate"),a.update()})}},{key:"getRates",value:function(){return"<ccys>"+this.session.get("provider").rates.split(";").map(function(a){return"<ccy><nodeValue>"+a+"</nodeValue></ccy>"}).join("")+"</ccys>"}},{key:"performForward",value:function(){this.jump("pay")}},{key:"parseRate",value:function(a){this.session.get("provider").rate=new b(a,this.session.get("provider").custom_calc_course,this.session.get("provider").rate_filter_from,this.session.get("provider").rate_filter_to,this.session.get("provider").rate_value,this.session.get("provider").rate_format,this.session.get("provider").rate_custom_format),this.rateInfo=this.session.get("provider").rate.formattedRate()}},{key:"createClass",value:function(){var a=this;return this.loadElements(["confirmItem"]).then(function(b){var d=_slicedToArray(b,1),e=d[0];return _get(Object.getPrototypeOf(c.prototype),"createClass",a).call(a,{render:function(){var a=this.props.context,b=null;return this.props.rateInfo&&(b=React.createElement(e,{label:qiwi.i18n("confirm_page.rate_label"),value:this.props.rateInfo})),React.createElement("div",{id:"confirm-page"},React.createElement("div",{className:"head"},React.createElement("div",null,qiwi.i18n("confirm_page.title"))),React.createElement("div",{className:"main"},React.createElement("div",{className:"itemsBackground"},React.createElement(e,{label:qiwi.i18n("confirm_page.account_label"),value:a.session.get("maskedAccount")}),React.createElement(e,{label:qiwi.i18n("confirm_page.phone_label"),value:qiwi.utils.mask(a.session.get("phone"),"+7 (***) *** ** **")}),b),React.createElement("div",{className:"oferta-message"},qiwi.i18n("language_page.oferta_text").replace(/(\[).*$/g,""),React.createElement("span",{className:"button",onClick:function(){return a.jump("oferta")}},qiwi.i18n("language_page.oferta_text").replace(/^.*(\[)|(\]).*$/g,"")),qiwi.i18n("language_page.oferta_text").replace(/.*(\])/g,""))))}})})}},{key:"state",get:function(){return{rateInfo:this.rateInfo}}}]),c}(a);return c});