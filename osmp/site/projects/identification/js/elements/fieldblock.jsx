"use strict";System.register(["jsx!elements/field"],function(t,e){var s;return{setters:[function(t){s=t["default"]}],execute:function(){t("default",React.createClass({propTypes:{defaultShim:React.PropTypes.shape({template:React.PropTypes.string.isRequired}),skipSuggests:React.PropTypes.bool,fields:React.PropTypes.shape({text:React.PropTypes.string,title:React.PropTypes.string,mask:React.PropTypes.shape({inner:React.PropTypes.string,shown:React.PropTypes.string})}),onUpdate:React.PropTypes.func,fieldFunctions:React.PropTypes.object},getDefaultProps:function(){return{defaultShim:{template:"Нажмите, чтобы увидеть"},skipSuggests:!1,onUpdate:function(){}}},defaultMaxSymbols:40,componentWillMount:function(){var t=this,e=this.props;e.fieldFunctions&&qiwi.utils.forEach(e.fieldFunctions,function(s,i){return e.fieldFunctions[i]=t[i]}),qiwi.utils.forEach(e.fields,function(t){t.text=t.text?t.mask&&t.mask.isMasked?qiwi.utils.demask(t.text,t.mask.inner):t.text.toString():"",t.shim=t.text?e.defaultShim:null}),this.current=qiwi.utils.findKey(e.fields,function(t){return!t.text}),e.onUpdate()},updateData:function(){this.props.onUpdate(this.current),this.forceUpdate()},highlight:function(t){var e=this;t.forEach(function(t){var s=e.props.fields[t];s.shim&&delete s.shim}),this.changeCurrent(t[0])},setFailedFields:function(t){var e=this;qiwi.utils.forEach(this.props.fields,function(s,i){-1!==t.indexOf(i)&&e.current!==i?s.shim=e.props.defaultShim:delete s.shim})},updateSuggests:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]?this.current:arguments[0];if(e){var s=this.props.fields[e];return s.autocomplete&&(s.suggests={fitted:s.text,array:s.autocomplete.apply(s.text),limit:2,onClick:function(e){return t.setValue(e)}},0===s.suggests.array.length)?this.removeSuggests(e):void 0}},removeSuggests:function(){var t=arguments.length<=0||void 0===arguments[0]?this.current:arguments[0];if(t){var e=this.props.fields[t];e.suggests&&delete e.suggests}},addSymbol:function(t){if(this.current&&1===t.toString().length){var e=this.props.fields[this.current];e.text+=(e.mask?qiwi.utils.mask(e.text,e.mask.inner).length>=e.mask.inner.length:e.text.length>=(e.maxSymbols||this.defaultMaxSymbols))?"":t.toString(),this.props.skipSuggests||this.updateSuggests(),this.updateData()}},setValue:function(t){if(this.current){var e=this.props.fields[this.current];e.text=e.mask?qiwi.utils.mask(t,e.mask.inner):t.slice(0,e.maxSymbols||this.defaultMaxSymbols),this.props.skipSuggests||this.removeSuggests(),this.updateData()}},removeSymbol:function(){if(this.current){var t=this.props.fields[this.current];t.text=t.text.slice(0,-1),this.props.skipSuggests||this.updateSuggests(),this.updateData()}},removeAll:function(){if(this.current){var t=this.props.fields[this.current];t.text="",this.props.skipSuggests||this.removeSuggests(),this.updateData()}},changeCurrent:function(t){if(t!==this.current){var e=this.props.fields[t],s=this.props.fields[this.current]||{};s.text&&(s.shim=this.props.defaultShim),e.shim&&delete e.shim,this.props.skipSuggests||this.removeSuggests(),this.current=t,this.updateData()}},render:function(){var t=this;return React.createElement("div",{className:"fieldBlock"},qiwi.utils.map(this.props.fields,function(e,i){return React.createElement(s,{text:e.text||"",title:e.title||null,suggests:e.suggests||null,mask:e.mask||null,shim:e.shim||null,isInactive:i!==t.current,eraseText:"X",eraseWidth:"60",onEraseClick:function(){return t.removeSymbol()},onClick:function(){return t.changeCurrent(i)},className:"little-text",width:"385",key:i})}))}}))}}});