"use strict";System.register(["jsx!elements/button","statistics"],function(_export,_context){var Button,Statistics;return{setters:[function(_jsxElementsButton){Button=_jsxElementsButton["default"]},function(_statistics){Statistics=_statistics["default"]}],execute:function(){_export("default",React.createClass({getDefaultProps:function(){return{showOptions:{},controlOptions:{},defaultLanguage:"рус"}},shouldComponentUpdate:function(nextProps,nextState){return this.state.language!=nextState.language||this.state.numeric!=nextState.numeric||this.state.shift!=nextState.shift},getInitialState:function(){return{language:this.props.defaultLanguage,numeric:!1,shift:!0}},componentWillReceiveProps:function(props){qiwi.utils.isBoolean(props.numeric)&&this.setState({numeric:props.numeric}),props.language?this.setState({numeric:!1,language:props.language}):this.setState({language:props.specialKeyboard||this.layouts[this.state.language]["default"]?this.state.language:props.defaultLanguage}),qiwi.utils.isBoolean(props.shift)&&this.setState({shift:props.shift})},componentWillMount:function(){this.props.specialKeyboard?(this.layouts.special={mapping:this.props.specialKeyboard.layout,example:this.props.specialKeyboard.shift},this.setState({language:"special",numeric:!1,shift:!1})):this.componentWillReceiveProps(this.props)},layouts:{"рус":{mapping:[["й","ц","у","к","е","н","г","ш","щ","з","х","ъ"],["ф","ы","в","а","п","р","о","л","д","ж","э"],["я","ч","с","м","и","т","ь","б","ю","ё"]],example:"абв","default":!0},eng:{mapping:[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l"],["z","x","c","v","b","n","m"]],example:"abc","default":!0},num:{mapping:[["1","2","3","4","5","6","7","8","9","0","@","-"],["#","%","$","+","(",")","*",":"],[";","_","/",",",".","!","?"]],example:"?123"},email:{mapping:[["0","1","2","3","4","5","6","7","8","9"],["q","w","e","r","t","y","u","i","o","p","_","@"],["a","s","d","f","g","h","j","k","l","."],["z","x","c","v","b","n","m","-"]],example:"@bc"}},nextLanguage:function(){var _this=this,langs=Object.keys(this.layouts).filter(function(item){return _this.layouts[item]["default"]}),currentIndex=langs.indexOf(this.state.language);return currentIndex===langs.length-1?langs[0]:langs[currentIndex+1]},getInverseExample:function(){var example=this.layouts[this.state.language].example;return this.state.shift?example.toLowerCase():example.toUpperCase()},language:function(){this.setState({language:this.nextLanguage(),numeric:!1})},numeric:function(){this.setState({numeric:!this.state.numeric})},shift:function(){this.setState({shift:!this.state.shift,numeric:!1})},onEraseAll:function(){Statistics.click({button:"clear"}),this.props.onEraseAll()},render:function(){var _this2=this,keyboard=this.layouts[this.state.numeric?"num":this.state.language].mapping.map(function(row,rowNum){return row=row.map(function(cell,index){return cell=_this2.state.shift?cell.toUpperCase():cell.toLowerCase(),React.createElement(Button,{className:"key key-"+index,data:cell,text:_this2.props.showOptions.alwaysCaps?cell.toUpperCase():cell,onClick:_this2.props.onClick})}),2!==rowNum||_this2.state.numeric||_this2.props.specialKeyboard&&_this2.props.specialKeyboard.shift||_this2.props.controlOptions.shiftDisabled||row.unshift(React.createElement(Button,{key:"shift",className:"key special",onClick:_this2.shift,text:_this2.getInverseExample()})),row}),eraser=React.createElement(Button,{key:"erase-all",className:"key special erase-all",onClick:this.onEraseAll,text:"СТЕРЕТЬ ВСЕ"});return this.props.specialKeyboard||keyboard.push([this.props.controlOptions.numericDisabled||!this.layouts[this.state.language]["default"]?null:React.createElement(Button,{key:"numeric",className:"key special",onClick:this.numeric,text:this.state.numeric?this.layouts[this.state.language].example:"?123"}),this.props.controlOptions.languageDisabled||!this.layouts[this.state.language]["default"]||this.state.numeric?null:React.createElement(Button,{key:"language",className:"key special",onClick:this.language,text:this.nextLanguage().toUpperCase()}),this.props.controlOptions.spaceDisabled?null:React.createElement(Button,{key:"space",className:"key space",text:" ",data:" ",onClick:this.props.onClick}),this.props.controlOptions.eraseDisabled?null:eraser]),this.props.specialKeyboard&&!this.props.controlOptions.eraseDisabled&&keyboard[keyboard.length-1].push(eraser),keyboard=keyboard.map(function(row){return row.filter(function(a){return a}).map(function(cell,index){return React.createElement("td",{key:"cell-"+index},cell)})}),React.createElement("div",{className:"keyboard"},keyboard.map(function(row,index){return React.createElement("table",{key:"row-"+index,className:"keyboard-row row-"+index},React.createElement("tr",null,row))}))}}))}}});