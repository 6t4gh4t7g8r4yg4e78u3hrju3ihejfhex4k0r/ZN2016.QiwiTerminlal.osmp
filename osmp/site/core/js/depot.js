"use strict";System.register([],function(_export,_context){function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass,Depot,FlashDepot;return{setters:[],execute:function(){_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),Depot=function(){function Depot(){_classCallCheck(this,Depot),this.FLASH="flash",this.HTML="html",this._config={}}return _createClass(Depot,[{key:"init",value:function(config){switch(config||(config={}),this._config.style=config.style||this.HTML,this._config.style){case this.FLASH:if(this._inited)return Promise.resolve();this._container=new FlashDepot;break;case this.HTML:if(this._inited)return Promise.resolve()}return this._inited=!0,this._container.init()}},{key:"get",value:function(key){return this._inited?this._container.get(key):Promise.reject("Depot is not inited yet!")}},{key:"set",value:function(key,value){return this._inited?this._container.set(key,value):Promise.reject("Depot is not inited yet!")}},{key:"remove",value:function(key){return this._inited?this._container.remove(key):Promise.reject("Depot is not inited yet!")}}]),Depot}(),FlashDepot=function(){function FlashDepot(){_classCallCheck(this,FlashDepot)}return _createClass(FlashDepot,[{key:"init",value:function(){var _this=this;return new Promise(function(resolve){var element=document.createElement("embed");element.setAttribute("id","embed_depot"),element.setAttribute("name","embed_depot"),element.setAttribute("src","../swf/depot.swf"),element.setAttribute("type","application/x-shockwave-flash"),element.setAttribute("width","1"),element.setAttribute("height","1"),element.setAttribute("allowscriptaccess","always"),element.onready=function(){return resolve(element)},document.body.appendChild(element)}).then(function(element){return _this._element=element})}},{key:"get",value:function(key){if(!this._element||!this._element.get)return Promise.reject("There is no flash element defined!");var result=this._element.get(key);return result?Promise.resolve(JSON.parse(result).data):Promise.resolve(result)}},{key:"set",value:function(key,value){return this._element&&this._element.set?(this._element.set(key,JSON.stringify({data:value})),Promise.resolve()):Promise.reject("There is no flash element defined!")}},{key:"remove",value:function(key){return this._element&&this._element.remove?(this._element.remove(key),Promise.resolve()):Promise.reject("There is no flash element defined!")}}]),FlashDepot}(),_export("default",new Depot)}}});