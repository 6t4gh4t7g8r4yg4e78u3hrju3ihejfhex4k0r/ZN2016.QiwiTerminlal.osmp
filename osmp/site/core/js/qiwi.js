"use strict";System.register(["errors","i18n","utils","router","storage","statistics","terminal"],function(_export,_context){var errors,i18n,utils,router,Storage,statistics,Terminal,events,constants,terminal,application,errorHandler;return{setters:[function(_errors){errors=_errors["default"]},function(_i18n){i18n=_i18n["default"]},function(_utils){utils=_utils["default"]},function(_router){router=_router["default"]},function(_storage){Storage=_storage["default"]},function(_statistics){statistics=_statistics["default"]},function(_terminal){Terminal=_terminal["default"]}],execute:function(){events={REACT:{POPUP:"popup",PRELOADER:"preloader",MODAL:"modal",HEADER:"header",NAVIGATION:"navigation",LOGO:"logo",PAGE_CLASS:"react",PAGE_DATA:"update"},TIMER:{PAUSE:"pause",RESET:"reset",RESUME:"resume",END:"end"},JUMP:"jump",BACK:"back",FORWARD:"forward",EXIT:"exit"},constants={defaultUrl:"./../../site/index.html"},terminal={id:0},application={core:{version:null},name:null,scenario:null,version:null,toString:function(){return""+this.name+(this.scenario&&"default"!=this.scenario?":"+this.scenario:"")+" v"+this.version+"/"+this.core.version}},errorHandler=function(app){return window.onerror=function(err,uri,line){var error=qiwi.errors.Base.current||new Error(err,line);switch(!0){case error instanceof qiwi.errors.FaultPopupError:console.warn("Fault error: "+error.toString()+" ("+error.internal+")");case error instanceof qiwi.errors.UserError:statistics.showPopup("popup_"+(router.current||null)+"_error"),console.log("User error: "+error.toString()+" ("+error.internal+")"),app.updateContext({popup:{type:"error",title:qiwi.i18n("errors.default"),message:"string"==typeof error.message?error.message:JSON.stringify(error.message),okHandler:qiwi.utils.isFunction(error.callback)?function(){return error.callback(app)}:function(){return qiwi.errors.ACTIONS.NOOP(app)}}});break;case error instanceof qiwi.errors.FaultError:case error instanceof qiwi.errors.Warning:statistics.error({type:"warning",message:error.toString()}),console.warn("Warning: "+error.toString());break;case error instanceof qiwi.errors.SystemError:default:statistics.error({type:"SystemError",message:error.toString(),line:error.original&&error.original.lineNumber||line,uri:error.original&&error.original.fileName||uri}),console.warn("System error: "+error.toString()),Terminal.send("network.sendmail",JSON.stringify({address:"bear@qiwi.com, luixo@qiwi.ru",text:("\n						Terminal: "+qiwi.terminal.id+"\n						Project: "+qiwi.application.toString()+"\n						Page: "+router.current+"\n						Timestamp: "+(new Date).toString()+"\n						Error: "+error.toString()+"\n						").replace(/\t/g,""),subject:"SSK App Error [Core: "+qiwi.application.name+"]"})),Terminal.send(Terminal.REQUEST,[{name:"PrvId",value:router.current?"15790":"15793"},{name:"PrvName",value:router.current?"AppError":"file_not_found"},{name:"AccNum",value:"0000000000"},{name:"_extra_comment",value:router.current?JSON.stringify({type:"unhandledError",additional:{message:error.toString(),source:"Core: "+qiwi.application.name+", page: "+router.current}}):JSON.stringify({type:"cantLoadFile",additional:{fileName:qiwi.application.name},version:document.regConfig&&document.regConfig&&document.regConfig.version})},{name:"_extra_no_print_check",value:"true"},{name:"_extra_fake_provider",value:"true"},{name:"CreatePay",value:"true"}]),Storage.set("interfaceStartParams","#change_type#"+JSON.stringify({page:"error"})),qiwi.errors.ACTIONS.EXIT(app)}qiwi.errors.Base.current=null}},_export("default",{application:application,constants:constants,errors:errors,events:events,i18n:i18n,terminal:terminal,utils:utils,errorHandler:errorHandler})}}});